@startuml
'https://plantuml.com/sequence-diagram

actor client
entity websocket
participant system
database db

==INITIAL CONNECTION==
activate client
client -> websocket :  connect(url)
activate websocket
websocket -> system : authenticateWebSocket(token)
activate system
system -> db : getTeams(id)
activate db
db --> system : teamsData
deactivate db
system --> websocket : authStatus
deactivate system
websocket --> client : connected
==BROADCAST LOCATION==
client -> websocket : sendLocation(location)
websocket --> client : broadcastLocation
== BROADCAST REPORT ==
client -> system : sendReport(location,type,isPublic,forPolice)
activate system
system -> db : insertReport(location,type,isPublic,forPolice)
activate db
db --> system : report
deactivate db
system --> websocket : report
deactivate system
websocket --> client : broadcastReport
==DISCONNECT==
client -> websocket : disconnect()
deactivate websocket
deactivate client

@enduml

<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="766px" preserveAspectRatio="none" style="width:764px;height:766px;background:#FFFFFF;" version="1.1" viewBox="0 0 764 766" width="764px" zoomAndPan="magnify"><defs/><g><g><title>client</title><rect fill="#FFFFFF" height="575.5898" style="stroke:#181818;stroke-width:1;" width="10" x="21.4946" y="91.4883"/></g><g><title>websocket</title><rect fill="#FFFFFF" height="510.9688" style="stroke:#181818;stroke-width:1;" width="10" x="197.752" y="156.1094"/></g><g><title>system</title><rect fill="#FFFFFF" height="87.9316" style="stroke:#181818;stroke-width:1;" width="10" x="416.9087" y="185.4199"/></g><g><title>system</title><rect fill="#FFFFFF" height="87.9316" style="stroke:#181818;stroke-width:1;" width="10" x="416.9087" y="477.2148"/></g><g><title>db</title><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1;" width="10" x="724.3931" y="214.7305"/></g><g><title>db</title><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1;" width="10" x="724.3931" y="506.5254"/></g><g><title>client</title><rect fill="#000000" fill-opacity="0.00000" height="603.5898" width="8" x="22.4946" y="81.4883"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="26" x2="26" y1="81.4883" y2="685.0781"/></g><g><title>websocket</title><rect fill="#000000" fill-opacity="0.00000" height="603.5898" width="8" x="198.752" y="81.4883"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="201.9897" x2="201.9897" y1="81.4883" y2="685.0781"/></g><g><title>system</title><rect fill="#000000" fill-opacity="0.00000" height="603.5898" width="8" x="417.9087" y="81.4883"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="421.0615" x2="421.0615" y1="81.4883" y2="685.0781"/></g><g><title>db</title><rect fill="#000000" fill-opacity="0.00000" height="603.5898" width="8" x="725.3931" y="81.4883"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="729.3931" x2="729.3931" y1="81.4883" y2="685.0781"/></g><g class="participant participant-head" data-participant="client"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36.9893" x="5" y="78.5352">client</text><ellipse cx="26.4946" cy="13.5" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M26.4946,21.5 L26.4946,48.5 M13.4946,29.5 L39.4946,29.5 M26.4946,48.5 L13.4946,63.5 M26.4946,48.5 L39.4946,63.5" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="client"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36.9893" x="5" y="697.6133">client</text><ellipse cx="26.4946" cy="709.0664" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M26.4946,717.0664 L26.4946,744.0664 M13.4946,725.0664 L39.4946,725.0664 M26.4946,744.0664 L13.4946,759.0664 M26.4946,744.0664 L39.4946,759.0664" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="websocket"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71.5244" x="163.9897" y="78.5352">websocket</text><ellipse cx="202.752" cy="49" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="190.752" x2="214.752" y1="63" y2="63"/></g><g class="participant participant-tail" data-participant="websocket"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71.5244" x="163.9897" y="697.6133">websocket</text><ellipse cx="202.752" cy="716.5664" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="190.752" x2="214.752" y1="730.5664" y2="730.5664"/></g><g class="participant participant-head" data-participant="system"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="61.6943" x="391.0615" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47.6943" x="398.0615" y="70.5352">system</text></g><g class="participant participant-tail" data-participant="system"><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="61.6943" x="391.0615" y="684.0781"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47.6943" x="398.0615" y="704.6133">system</text></g><g class="participant participant-head" data-participant="db"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="17.623" x="717.5815" y="78.5352">db</text><path d="M711.3931,29 C711.3931,19 729.3931,19 729.3931,19 C729.3931,19 747.3931,19 747.3931,29 L747.3931,55 C747.3931,65 729.3931,65 729.3931,65 C729.3931,65 711.3931,65 711.3931,55 L711.3931,29" fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;"/><path d="M711.3931,29 C711.3931,39 729.3931,39 729.3931,39 C729.3931,39 747.3931,39 747.3931,29" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="db"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="17.623" x="717.5815" y="697.6133">db</text><path d="M711.3931,710.5664 C711.3931,700.5664 729.3931,700.5664 729.3931,700.5664 C729.3931,700.5664 747.3931,700.5664 747.3931,710.5664 L747.3931,736.5664 C747.3931,746.5664 729.3931,746.5664 729.3931,746.5664 C729.3931,746.5664 711.3931,746.5664 711.3931,736.5664 L711.3931,710.5664" fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;"/><path d="M711.3931,710.5664 C711.3931,720.5664 729.3931,720.5664 729.3931,720.5664 C729.3931,720.5664 747.3931,720.5664 747.3931,710.5664" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g><title>client</title><rect fill="#FFFFFF" height="575.5898" style="stroke:#181818;stroke-width:1;" width="10" x="21.4946" y="91.4883"/></g><g><title>websocket</title><rect fill="#FFFFFF" height="510.9688" style="stroke:#181818;stroke-width:1;" width="10" x="197.752" y="156.1094"/></g><g><title>system</title><rect fill="#FFFFFF" height="87.9316" style="stroke:#181818;stroke-width:1;" width="10" x="416.9087" y="185.4199"/></g><g><title>system</title><rect fill="#FFFFFF" height="87.9316" style="stroke:#181818;stroke-width:1;" width="10" x="416.9087" y="477.2148"/></g><g><title>db</title><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1;" width="10" x="724.3931" y="214.7305"/></g><g><title>db</title><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1;" width="10" x="724.3931" y="506.5254"/></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="752.3931" x="0" y="112.1436"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="752.3931" y1="112.1436" y2="112.1436"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="752.3931" y1="115.1436" y2="115.1436"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="158.2949" x="297.0491" y="101.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="144.2949" x="303.0491" y="118.0566">INITIAL CONNECTION</text><g class="message" data-participant-1="client" data-participant-2="websocket"><polygon fill="#181818" points="185.752,152.1094,195.752,156.1094,185.752,160.1094,189.752,156.1094" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="31.4946" x2="191.752" y1="156.1094" y2="156.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75.1436" x="38.4946" y="151.3672">connect(url)</text></g><g class="message" data-participant-1="websocket" data-participant-2="system"><polygon fill="#181818" points="404.9087,181.4199,414.9087,185.4199,404.9087,189.4199,408.9087,185.4199" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="207.752" x2="410.9087" y1="185.4199" y2="185.4199"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190.1567" x="214.752" y="180.6777">authenticateWebSocket(token)</text></g><g class="message" data-participant-1="system" data-participant-2="db"><polygon fill="#181818" points="712.3931,210.7305,722.3931,214.7305,712.3931,218.7305,716.3931,214.7305" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="426.9087" x2="718.3931" y1="214.7305" y2="214.7305"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.0117" x="433.9087" y="209.9883">getTeams(id)</text></g><g class="message" data-participant-1="db" data-participant-2="system"><polygon fill="#181818" points="437.9087,240.041,427.9087,244.041,437.9087,248.041,433.9087,244.041" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="431.9087" x2="728.3931" y1="244.041" y2="244.041"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="67.0059" x="443.9087" y="239.2988">teamsData</text></g><g class="message" data-participant-1="system" data-participant-2="websocket"><polygon fill="#181818" points="218.752,269.3516,208.752,273.3516,218.752,277.3516,214.752,273.3516" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="212.752" x2="420.9087" y1="273.3516" y2="273.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66.7773" x="224.752" y="268.6094">authStatus</text></g><g class="message" data-participant-1="websocket" data-participant-2="client"><polygon fill="#181818" points="42.4946,298.6621,32.4946,302.6621,42.4946,306.6621,38.4946,302.6621" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="36.4946" x2="196.752" y1="302.6621" y2="302.6621"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64.9683" x="48.4946" y="297.9199">connected</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="752.3931" x="0" y="331.3174"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="752.3931" y1="331.3174" y2="331.3174"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="752.3931" y1="334.3174" y2="334.3174"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="172.3232" x="290.0349" y="320.6621"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="158.3232" x="296.0349" y="337.2305">BROADCAST LOCATION</text><g class="message" data-participant-1="client" data-participant-2="websocket"><polygon fill="#181818" points="185.752,371.2832,195.752,375.2832,185.752,379.2832,189.752,375.2832" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="31.4946" x2="191.752" y1="375.2832" y2="375.2832"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142.2573" x="38.4946" y="370.541">sendLocation(location)</text></g><g class="message" data-participant-1="websocket" data-participant-2="client"><polygon fill="#181818" points="42.4946,400.5938,32.4946,404.5938,42.4946,408.5938,38.4946,404.5938" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="36.4946" x2="196.752" y1="404.5938" y2="404.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115.6035" x="48.4946" y="399.8516">broadcastLocation</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="752.3931" x="0" y="433.249"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="752.3931" y1="433.249" y2="433.249"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="752.3931" y1="436.249" y2="436.249"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="158.9297" x="296.7317" y="422.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="140.645" x="302.7317" y="439.1621">BROADCAST REPORT</text><g class="message" data-participant-1="client" data-participant-2="system"><polygon fill="#181818" points="404.9087,473.2148,414.9087,477.2148,404.9087,481.2148,408.9087,477.2148" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="31.4946" x2="410.9087" y1="477.2148" y2="477.2148"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="272.7271" x="38.4946" y="472.4727">sendReport(location,type,isPublic,forPolice)</text></g><g class="message" data-participant-1="system" data-participant-2="db"><polygon fill="#181818" points="712.3931,502.5254,722.3931,506.5254,712.3931,510.5254,716.3931,506.5254" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="426.9087" x2="718.3931" y1="506.5254" y2="506.5254"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="278.4844" x="433.9087" y="501.7832">insertReport(location,type,isPublic,forPolice)</text></g><g class="message" data-participant-1="db" data-participant-2="system"><polygon fill="#181818" points="437.9087,531.8359,427.9087,535.8359,437.9087,539.8359,433.9087,535.8359" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="431.9087" x2="728.3931" y1="535.8359" y2="535.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="38.9111" x="443.9087" y="531.0938">report</text></g><g class="message" data-participant-1="system" data-participant-2="websocket"><polygon fill="#181818" points="218.752,561.1465,208.752,565.1465,218.752,569.1465,214.752,565.1465" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="212.752" x2="420.9087" y1="565.1465" y2="565.1465"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="38.9111" x="224.752" y="560.4043">report</text></g><g class="message" data-participant-1="websocket" data-participant-2="client"><polygon fill="#181818" points="42.4946,590.457,32.4946,594.457,42.4946,598.457,38.4946,594.457" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="36.4946" x2="196.752" y1="594.457" y2="594.457"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.9873" x="48.4946" y="589.7148">broadcastReport</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="752.3931" x="0" y="623.1123"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="752.3931" y1="623.1123" y2="623.1123"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="752.3931" y1="626.1123" y2="626.1123"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="102.0293" x="325.1819" y="612.457"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="88.0293" x="331.1819" y="629.0254">DISCONNECT</text><g class="message" data-participant-1="client" data-participant-2="websocket"><polygon fill="#181818" points="190.752,663.0781,200.752,667.0781,190.752,671.0781,194.752,667.0781" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="26.4946" x2="196.752" y1="667.0781" y2="667.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76.5654" x="33.4946" y="662.3359">disconnect()</text></g><!--SRC=[bLF9ReCm4Btp5RwLI4bpZqGbId90YY02f9wDFKsiW4tjeLN-lYOnmMtJxO2mp5jctWnt1yJEh9RBhg4I-xQvPwfT6dZfGJ9OS47tchP1G1agJLWZG69W7u4dyWQrKUm867HKes2YinB4d0n26t2AjAO62A-388hIBAtIU4kIFCisIPNcMHGDekAL8eowbnTPF4pIP4K8Kr82mx3NpMpYJEuJs38lzfP6UpmCXJ8BVeAwF2D2L4UGdeghrh4idzUMkmUiWBOc5Dp3saxiruLlWWDgRLiDEFYuKUzJAqDD9LBiZOztDNXjM9hBOZLs3zoc-5ZayJg9oufiyoHsATvEpO3aMsMR5qg6ZJlClZEfjQASKOCZnPgHoQtOxFAY8X_ChXaCJWLqIkFLPuwd3kR2xFgw4Mp-hFHEsGFy6hoG1ZJ-N-t6QFHPv6zp-OhzUIRNk2wLsh3MQUbM-zk9S676JPxvLjCYUvVkZtW7]--></g></svg>

